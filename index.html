<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云中极客 的 AI 实验室 | Vibe Coding 进化录</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FontAwesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- 中文字体 -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700;900&family=Noto+Sans+SC:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['Noto Serif SC', 'STSong', 'SimSun', 'serif'],
                        sans: ['Noto Sans SC', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        ink: {
                            50: '#f8f8f8',
                            100: '#e8e8e8',
                            200: '#d0d0d0',
                            300: '#b0b0b0',
                            400: '#888888',
                            500: '#606060',
                            600: '#404040',
                            700: '#2a2a2a',
                            800: '#1a1a1a',
                            900: '#0a0a0a',
                        },
                        cinnabar: {
                            light: '#ff6b5b',
                            DEFAULT: '#c45c48',
                            dark: '#8b3a2f',
                        },
                        gold: {
                            light: '#f5e6c8',
                            DEFAULT: '#d4af37',
                            dark: '#b8941d',
                        },
                        jade: {
                            light: '#7dd3c0',
                            DEFAULT: '#4a9b8a',
                            dark: '#2d5f54',
                        }
                    },
                    animation: {
                        'float': 'float 4s ease-in-out infinite',
                        'ink-flow': 'inkFlow 8s ease-in-out infinite',
                        'breathe': 'breathe 3s ease-in-out infinite',
                        'shimmer': 'shimmer 3s linear infinite',
                        'thinking': 'thinking 2s ease-in-out infinite',
                        'chat-active': 'chatActive 1s ease-in-out infinite',
                        'wave': 'wave 1s ease-in-out',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-8px)' },
                        },
                        inkFlow: {
                            '0%, 100%': { transform: 'translate(0, 0) scale(1)' },
                            '33%': { transform: 'translate(10px, -10px) scale(1.02)' },
                            '66%': { transform: 'translate(-5px, 5px) scale(0.98)' },
                        },
                        breathe: {
                            '0%, 100%': { opacity: '0.6', transform: 'scale(1)' },
                            '50%': { opacity: '1', transform: 'scale(1.02)' },
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-200% 0' },
                            '100%': { backgroundPosition: '200% 0' },
                        },
                        thinking: {
                            '0%, 100%': { transform: 'translateY(0) rotate(0deg)' },
                            '25%': { transform: 'translateY(-2px) rotate(1deg)' },
                            '50%': { transform: 'translateY(0) rotate(0deg)' },
                            '75%': { transform: 'translateY(-2px) rotate(-1deg)' },
                        },
                        chatActive: {
                            '0%, 100%': { transform: 'scale(1)' },
                            '50%': { transform: 'scale(1.02)' },
                        },
                        wave: {
                            '0%': { transform: 'scale(1)' },
                            '50%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)' },
                        },
                    }
                }
            }
        }
    </script>

    <style>
        /* 全局样式 - 宣纸纹理背景 */
        body {
            background: linear-gradient(180deg, #f5f3ef 0%, #ebe7e0 50%, #f5f3ef 100%);
            min-height: 100vh;
            position: relative;
        }

        /* 宣纸纹理 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 1;
        }

        /* 水墨流体 Canvas */
        #ink-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.4;
        }

        /* 水墨晕染装饰 */
        .ink-blob {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.08) 0%, rgba(0, 0, 0, 0.02) 40%, transparent 70%);
            filter: blur(20px);
            animation: inkFlow 10s ease-in-out infinite;
        }

        /* 祥云纹样 */
        .cloud-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='30' viewBox='0 0 60 30' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 15 Q15 5 25 15 T45 15' fill='none' stroke='rgba(0,0,0,0.05)' stroke-width='1'/%3E%3C/svg%3E");
            background-repeat: repeat;
        }

        /* 中式边框 */
        .chinese-border {
            position: relative;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .chinese-border::before,
        .chinese-border::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #c45c48;
        }

        .chinese-border::before {
            top: -1px;
            left: -1px;
            border-right: none;
            border-bottom: none;
        }

        .chinese-border::after {
            bottom: -1px;
            right: -1px;
            border-left: none;
            border-top: none;
        }

        /* 竖排文字 */
        .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }

        /* 印章效果 */
        .seal {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 4px 12px;
            border: 2px solid #c45c48;
            color: #c45c48;
            font-family: 'Noto Serif SC', serif;
            font-weight: 700;
            border-radius: 4px;
            position: relative;
        }

        .seal::before {
            content: '';
            position: absolute;
            inset: 2px;
            border: 1px solid rgba(196, 92, 72, 0.3);
            border-radius: 2px;
        }

        /* 水墨卡片 */
        .ink-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow:
                0 4px 20px rgba(0, 0, 0, 0.05),
                0 1px 3px rgba(0, 0, 0, 0.03);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .ink-card:hover {
            transform: translateY(-4px);
            box-shadow:
                0 12px 40px rgba(0, 0, 0, 0.1),
                0 4px 12px rgba(0, 0, 0, 0.05);
            border-color: rgba(196, 92, 72, 0.2);
        }

        /* 竹简终端 */
        .bamboo-terminal {
            background: linear-gradient(180deg, #e8dcc8 0%, #d4c8b4 100%);
            border: 1px solid #b8a88c;
            box-shadow:
                inset 0 2px 4px rgba(255, 255, 255, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .bamboo-terminal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(0deg,
                    transparent,
                    transparent 28px,
                    rgba(0, 0, 0, 0.03) 28px,
                    rgba(0, 0, 0, 0.03) 30px);
            pointer-events: none;
        }

        /* 竹简绑绳效果 */
        .bamboo-bind {
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 8px;
            background: linear-gradient(90deg, #8b4513 0%, #a0522d 50%, #8b4513 100%);
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.2);
        }

        /* 毛笔字效果 */
        .brush-text {
            font-family: 'Noto Serif SC', serif;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.05em;
        }

        /* 金色渐变文字 */
        .gold-text {
            background: linear-gradient(135deg, #d4af37 0%, #f5e6c8 50%, #d4af37 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* 水墨渐变 */
        .ink-gradient {
            background: linear-gradient(135deg,
                    rgba(0, 0, 0, 0.02) 0%,
                    rgba(0, 0, 0, 0.05) 50%,
                    rgba(0, 0, 0, 0.02) 100%);
        }

        /* 拖拽头像样式 */
        #anime-avatar {
            cursor: grab;
            user-select: none;
            transition: transform 0.1s ease;
        }

        #anime-avatar:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        #anime-avatar.dragging {
            cursor: grabbing;
        }

        /* 滚动条 - 中式风格 */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f5f3ef;
        }

        ::-webkit-scrollbar-thumb {
            background: #c0b8a8;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a09888;
        }

        /* 隐藏 Coze 默认悬浮球和所有相关图标 */
        .coze-web-chat-floating-btn,
        .coze-floating-btn,
        .coze-chat-btn,
        .coze-widget-btn,
        [class*="coze"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
            position: fixed !important;
            left: -9999px !important;
            top: -9999px !important;
            width: 0 !important;
            height: 0 !important;
        }

        /* 确保动漫人物的层级较高 */
        #anime-avatar {
            z-index: 9998 !important;
            position: fixed !important;
            pointer-events: auto !important;
        }

        /* Coze 对话框样式定制 */
        .coze-web-chat-container {
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(255, 0, 0, 0.3), 0 0 0 4px rgba(255, 255, 255, 0.1), 0 0 0 6px rgba(196, 92, 72, 0.2) !important;
            z-index: 9999 !important;
        }

        /* 人物状态变化样式 */
        #anime-avatar.dragging {
            cursor: grabbing !important;
        }

        #anime-avatar:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 12px 40px rgba(255, 0, 0, 0.4)), drop-shadow(0 4px 16px rgba(255, 0, 0, 0.3));
        }

        /* 流光卡片 - 国风版 */
        .streamer-card {
            position: relative;
            overflow: hidden;
        }

        .streamer-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg,
                    transparent 30%,
                    rgba(196, 92, 72, 0.05) 40%,
                    rgba(212, 175, 55, 0.08) 50%,
                    rgba(74, 155, 138, 0.05) 60%,
                    transparent 70%);
            background-size: 200% 200%;
            animation: streamer 6s linear infinite;
            z-index: 0;
        }

        @keyframes streamer {
            0% {
                transform: translate(-30%, -30%) rotate(0deg);
            }

            100% {
                transform: translate(30%, 30%) rotate(360deg);
            }
        }

        /* 动态红光动画 */
        @keyframes glow {

            0%,
            100% {
                filter: drop-shadow(0 8px 32px rgba(255, 0, 0, 0.3)) drop-shadow(0 4px 12px rgba(255, 0, 0, 0.2));
            }

            50% {
                filter: drop-shadow(0 8px 36px rgba(255, 0, 0, 0.4)) drop-shadow(0 4px 16px rgba(255, 0, 0, 0.3));
            }
        }

        /* 3D 视差效果 */
        .parallax-active {
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        /* 轻微 3D 效果 - 等待真实 3D 模型替换 */
        #ai-character {
            transform-style: preserve-3d;
        }

        #ai-character img {
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        /* 悬停时的轻微效果 */
        #ai-character:hover img {
            transform: scale(1.02);
            filter: drop-shadow(0 10px 25px rgba(196, 92, 72, 0.3));
        }

        /* 轻微阴影 */
        #ai-wrapper {
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.1));
        }

        /* 山水装饰 */
        .mountain-decoration {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.05) 0%, transparent 100%);
            pointer-events: none;
        }

        /* 水墨笔触装饰线 */
        .ink-stroke {
            height: 2px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(0, 0, 0, 0.2) 20%,
                    rgba(0, 0, 0, 0.3) 50%,
                    rgba(0, 0, 0, 0.2) 80%,
                    transparent 100%);
            position: relative;
        }

        .ink-stroke::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #c45c48;
            border-radius: 50%;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {

            /* AI 角色响应式调整 */
            #ai-character {
                width: 80px !important;
                height: 100px !important;
                right: 16px !important;
                bottom: 80px !important;
            }

            #ai-character img {
                width: 100% !important;
                height: 100% !important;
            }

            /* 聊天面板响应式调整 */
            #chat-panel {
                right: 16px !important;
                bottom: 80px !important;
                width: 90% !important;
                max-width: 280px !important;
                height: 350px !important;
            }

            /* 消息列表调整 */
            #message-list {
                font-size: 14px !important;
            }

            /* 输入区调整 */
            #chat-input {
                font-size: 14px !important;
                padding: 8px 12px !important;
            }

            #send-message {
                padding: 0 16px !important;
            }
        }

        @media (max-width: 480px) {

            /* AI 角色进一步调整 */
            #ai-character {
                width: 60px !important;
                height: 80px !important;
                right: 12px !important;
                bottom: 60px !important;
            }

            /* 聊天面板进一步调整 */
            #chat-panel {
                right: 12px !important;
                bottom: 60px !important;
                width: 95% !important;
                max-width: 260px !important;
                height: 300px !important;
            }
        }
    </style>
</head>

<body class="text-ink-800 font-sans overflow-x-hidden">
    <!-- 水墨流体 Canvas -->
    <canvas id="ink-canvas"></canvas>

    <!-- 水墨晕染装饰 -->
    <div class="ink-blob" style="width: 400px; height: 400px; top: -100px; right: -100px;"></div>
    <div class="ink-blob" style="width: 300px; height: 300px; bottom: 20%; left: -80px; animation-delay: -3s;"></div>
    <div class="ink-blob" style="width: 200px; height: 200px; top: 40%; right: 10%; animation-delay: -5s;"></div>

    <!-- 主内容区 -->
    <main class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- Hero 区 -->
        <section class="text-center mb-20 pt-8 relative">
            <!-- 装饰竖线 -->
            <div class="absolute left-8 top-1/2 -translate-y-1/2 hidden lg:block">
                <div class="vertical-text text-ink-400 text-sm tracking-widest" style="writing-mode: vertical-rl;">
                    意图重于语法 · AI 驱动进化
                </div>
            </div>

            <div class="inline-flex items-center gap-2 px-4 py-2 mb-8">
                <span class="w-2 h-2 rounded-full bg-jade"></span>
                <span class="text-sm text-ink-500 font-serif tracking-wider">AI Native 开发者 · 进化日志</span>
            </div>

            <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6 brush-text text-ink-900">
                <span class="text-cinnabar">[</span>云中极客<span class="text-cinnabar">]</span> 的 AI 实验室
            </h1>

            <div class="ink-stroke max-w-md mx-auto mb-6"></div>

            <p class="text-lg sm:text-xl text-ink-600 mb-10 max-w-2xl mx-auto font-serif leading-relaxed">
                从直觉编程到架构思维：我的 Vibe Coding 进化录
            </p>

            <div class="flex flex-wrap justify-center gap-4">
                <span class="seal text-sm">
                    <i class="fas fa-bolt mr-2"></i>八小时MVP
                </span>
                <span class="seal text-sm" style="border-color: #4a9b8a; color: #4a9b8a;">
                    <i class="fas fa-user-ninja mr-2"></i>一人成军
                </span>
                <span class="seal text-sm" style="border-color: #d4af37; color: #b8941d;">
                    <i class="fas fa-scroll mr-2"></i>调试兵法
                </span>
            </div>
        </section>

        <!-- 项目路演 (Bento Grid) -->
        <section class="mb-20">
            <div class="flex items-center gap-4 mb-10">
                <div class="w-12 h-12 rounded-full bg-ink-100 flex items-center justify-center border border-ink-200">
                    <i class="fas fa-rocket text-cinnabar text-lg"></i>
                </div>
                <h2 class="text-2xl font-bold brush-text text-ink-900">项目路演</h2>
                <div class="flex-1 h-px bg-gradient-to-r from-ink-200 to-transparent"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- SubSlayer - 大卡片 -->
                <a href="https://subslayer-brown.vercel.app/" target="_blank"
                    class="ink-card rounded-xl p-6 lg:col-span-2 relative overflow-hidden hover:transform hover:scale-105 transition-all duration-300 cursor-pointer">
                    <div class="absolute top-0 right-0 w-32 h-32 opacity-5">
                        <svg viewBox="0 0 100 100" fill="currentColor">
                            <path d="M50 10 L90 90 L10 90 Z" />
                        </svg>
                    </div>
                    <div class="flex items-start justify-between mb-4 relative z-10">
                        <div class="flex items-center gap-4">
                            <div
                                class="w-14 h-14 rounded-lg bg-gradient-to-br from-cinnabar to-orange-600 flex items-center justify-center shadow-lg">
                                <i class="fas fa-skull-crossbones text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-ink-900 brush-text">SubSlayer</h3>
                                <p class="text-sm text-cinnabar font-serif">订阅刺客</p>
                            </div>
                        </div>
                        <span
                            class="px-3 py-1 rounded-full bg-cinnabar/10 text-cinnabar text-xs font-serif border border-cinnabar/20">
                            SaaS
                        </span>
                    </div>
                    <p class="text-ink-600 mb-5 font-serif leading-relaxed">实时追踪订阅服务流失，智能预警助你止血。</p>
                    <div class="flex flex-wrap gap-2">
                        <span
                            class="px-3 py-1.5 rounded-lg bg-cinnabar/5 text-cinnabar text-xs font-serif border border-cinnabar/10">
                            <i class="fas fa-chart-line mr-1"></i>实时流失计数器
                        </span>
                        <span
                            class="px-3 py-1.5 rounded-lg bg-orange-500/5 text-orange-600 text-xs font-serif border border-orange-500/10">
                            <i class="fas fa-band-aid mr-1"></i>止血特效
                        </span>
                    </div>
                </a>

                <!-- Mirror AI - 竖卡片 -->
                <a href="https://a8dc31cae001481e9ae6189c95daeafc.prod.enter.pro" target="_blank"
                    class="ink-card rounded-xl p-6 relative overflow-hidden hover:transform hover:scale-105 transition-all duration-300 cursor-pointer">
                    <div class="flex items-center gap-4 mb-5">
                        <div
                            class="w-14 h-14 rounded-lg bg-gradient-to-br from-jade to-teal-600 flex items-center justify-center shadow-lg">
                            <i class="fas fa-heart text-white text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-ink-900 brush-text">Mirror AI</h3>
                            <p class="text-sm text-jade font-serif">心镜</p>
                        </div>
                    </div>
                    <p class="text-ink-600 mb-5 font-serif leading-relaxed">AI 情感陪伴应用，用技术传递温暖。</p>
                    <div class="space-y-3">
                        <div class="flex items-center gap-2 text-xs text-jade font-serif">
                            <i class="fas fa-check-circle"></i>
                            <span>Supabase Trigger 攻克鉴权</span>
                        </div>
                        <div class="flex items-center gap-2 text-xs text-teal-600 font-serif">
                            <i class="fas fa-check-circle"></i>
                            <span>技术温情化</span>
                        </div>
                    </div>
                </a>

                <!-- SecurePass Lite -->
                <a href="https://securepass-lite.vercel.app/" target="_blank"
                    class="ink-card rounded-xl p-6 relative overflow-hidden hover:transform hover:scale-105 transition-all duration-300 cursor-pointer">
                    <div class="flex items-center gap-4 mb-5">
                        <div
                            class="w-14 h-14 rounded-lg bg-gradient-to-br from-gold to-yellow-600 flex items-center justify-center shadow-lg">
                            <i class="fas fa-shield-alt text-white text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-ink-900 brush-text">SecurePass Lite</h3>
                            <p class="text-sm text-gold-dark font-serif">密码管理器</p>
                        </div>
                    </div>
                    <p class="text-ink-600 mb-5 font-serif leading-relaxed">纯前端密码生成与管理，零后端依赖。</p>
                    <div class="flex flex-wrap gap-2">
                        <span
                            class="px-3 py-1.5 rounded-lg bg-gold/10 text-gold-dark text-xs font-serif border border-gold/20">
                            <i class="fas fa-lock mr-1"></i>无后端离线安全
                        </span>
                        <span
                            class="px-3 py-1.5 rounded-lg bg-yellow-500/5 text-yellow-700 text-xs font-serif border border-yellow-500/10">
                            <i class="fas fa-puzzle-piece mr-1"></i>Web/插件双模式
                        </span>
                    </div>
                </a>

                <!-- AI 导航站 - 流光动画 -->
                <a href="https://personal-ai-tools-seven.vercel.app/" target="_blank"
                    class="ink-card streamer-card rounded-xl p-6 lg:col-span-2 relative overflow-hidden hover:transform hover:scale-105 transition-all duration-300 cursor-pointer">
                    <div class="relative z-10">
                        <div class="flex items-start justify-between mb-5">
                            <div class="flex items-center gap-4">
                                <div
                                    class="w-14 h-14 rounded-lg bg-gradient-to-br from-cinnabar via-gold to-jade flex items-center justify-center shadow-lg">
                                    <i class="fas fa-compass text-white text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-ink-900 brush-text">AI 导航站</h3>
                                    <p class="text-sm text-ink-500 font-serif">工具聚合平台</p>
                                </div>
                            </div>
                            <span
                                class="px-3 py-1 rounded-full bg-gradient-to-r from-cinnabar/10 to-gold/10 text-cinnabar text-xs font-serif border border-cinnabar/20">
                                <i class="fas fa-star mr-1"></i>Featured
                            </span>
                        </div>
                        <p class="text-ink-600 mb-5 font-serif leading-relaxed">汇聚全球优质 AI 工具，一站式发现与体验。</p>
                        <div class="flex items-center gap-6 text-sm text-ink-500 font-serif">
                            <span class="flex items-center gap-2">
                                <i class="fas fa-link text-cinnabar"></i>
                                50+ 工具收录
                            </span>
                            <span class="flex items-center gap-2">
                                <i class="fas fa-bolt text-gold"></i>
                                每日更新
                            </span>
                        </div>
                    </div>
                    <!-- 角落装饰 -->
                    <div class="absolute bottom-2 right-2 text-ink-200 opacity-30">
                        <i class="fas fa-yin-yang text-4xl"></i>
                    </div>
                </a>
            </div>
        </section>

        <!-- AI 进化论 (竹简终端风格) -->
        <section class="mb-20">
            <div class="flex items-center gap-4 mb-10">
                <div class="w-12 h-12 rounded-full bg-ink-100 flex items-center justify-center border border-ink-200">
                    <i class="fas fa-scroll text-jade text-lg"></i>
                </div>
                <h2 class="text-2xl font-bold brush-text text-ink-900">AI 进化论</h2>
                <div class="flex-1 h-px bg-gradient-to-r from-ink-200 to-transparent"></div>
            </div>

            <div class="bamboo-terminal rounded-xl overflow-hidden relative">
                <!-- 竹简绑绳 -->
                <div class="bamboo-bind"></div>
                <div class="bamboo-bind" style="left: auto; right: 20px;"></div>

                <!-- 终端内容 -->
                <div class="p-8 pl-12 pr-12 font-serif text-sm leading-loose space-y-6 relative z-10">
                    <!-- 思维转变 -->
                    <div class="terminal-line">
                        <span class="text-jade font-bold">【思维转变】</span>
                    </div>
                    <div class="pl-4 border-l-2 border-cinnabar/30 ml-2">
                        <p class="text-ink-700 leading-relaxed">
                            <span class="text-ink-400 line-through">盲目对话</span>
                            <span class="text-ink-400 mx-2">→</span>
                            <span class="text-cinnabar font-bold">PRD + 版本规划 + 日志记录</span>
                        </p>
                        <p class="text-ink-400 text-xs mt-2 italic">// 从混沌到秩序，从直觉到工程化</p>
                    </div>

                    <!-- 调试兵法 -->
                    <div class="terminal-line mt-6">
                        <span class="text-jade font-bold">【调试兵法】</span>
                    </div>
                    <div class="pl-4 border-l-2 border-gold/30 ml-2">
                        <p class="text-ink-700 leading-relaxed">
                            <span class="text-gold-dark font-bold text-base">「三輪法則」</span>
                        </p>
                        <p class="text-ink-600 mt-1">同一个 Bug AI 修三轮修不好，立刻换模型。</p>
                        <p class="text-ink-400 text-xs mt-2 italic">// 不恋战，不迷信，保持清醒</p>
                    </div>

                    <!-- 工具心法 -->
                    <div class="terminal-line mt-6">
                        <span class="text-jade font-bold">【工具心法】</span>
                    </div>
                    <div class="pl-4 border-l-2 border-jade/30 ml-2">
                        <div class="space-y-3">
                            <p class="text-ink-700">
                                <span class="text-cinnabar font-bold">Vercel</span>
                                <span class="text-ink-400 mx-2">:</span>
                                <span class="text-ink-600">极速部署，秒级上线</span>
                            </p>
                            <p class="text-ink-700">
                                <span class="text-jade font-bold">Trae</span>
                                <span class="text-ink-400 mx-2">:</span>
                                <span class="text-ink-600">深度开发，AI 结对编程</span>
                            </p>
                            <p class="text-ink-700">
                                <span class="text-gold-dark font-bold">GitHub Desktop</span>
                                <span class="text-ink-400 mx-2">:</span>
                                <span class="text-ink-600">Trae 搞坏文件时的兜底神器</span>
                            </p>
                        </div>
                    </div>

                    <!-- 核心金句 -->
                    <div
                        class="mt-8 p-6 rounded-lg bg-gradient-to-r from-cinnabar/5 via-gold/5 to-jade/5 border border-ink-200 relative overflow-hidden">
                        <!-- 引号装饰 -->
                        <div class="absolute top-2 left-4 text-6xl text-ink-200 font-serif opacity-30">"</div>
                        <div class="absolute bottom-2 right-4 text-6xl text-ink-200 font-serif opacity-30">"</div>

                        <p class="text-lg text-center font-bold text-ink-800 leading-loose relative z-10 brush-text">
                            不用思考语法，只用掌控意图。<br>
                            这种一人成军的爽感，就是 Vibe Coding。
                        </p>
                    </div>

                    <!-- 落款 -->
                    <div class="text-right mt-4">
                        <span class="text-ink-400 text-xs font-serif">—— 乙巳年冬月于代码斋</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- 底部 -->
        <footer class="text-center py-12 border-t border-ink-200 relative">
            <!-- 山水装饰 -->
            <div class="mountain-decoration"></div>

            <div class="flex justify-center gap-6 mb-6 relative z-10">
                <a href="https://github.com/yourusername" target="_blank"
                    class="w-12 h-12 rounded-full bg-ink-100 border border-ink-200 flex items-center justify-center text-ink-600 hover:text-cinnabar hover:border-cinnabar hover:bg-cinnabar/5 transition-all">
                    <i class="fab fa-github text-xl"></i>
                </a>
                <a href="mailto:your@email.com"
                    class="w-12 h-12 rounded-full bg-ink-100 border border-ink-200 flex items-center justify-center text-ink-600 hover:text-jade hover:border-jade hover:bg-jade/5 transition-all">
                    <i class="fas fa-envelope text-xl"></i>
                </a>
                <a href="#"
                    class="w-12 h-12 rounded-full bg-ink-100 border border-ink-200 flex items-center justify-center text-ink-600 hover:text-gold-dark hover:border-gold hover:bg-gold/5 transition-all">
                    <i class="fab fa-twitter text-xl"></i>
                </a>
            </div>
            <p class="text-ink-400 text-sm font-serif relative z-10">
                <span class="text-cinnabar">©</span> 2026 AI 实验室
                <span class="mx-2">|</span>
                以 <span class="text-cinnabar">心</span> 编程 · 以 <span class="text-jade">道</span> 驭器
            </p>
        </footer>
    </main>

    <!-- AI 根容器（解决层叠上下文问题） -->
    <div id="ai-root" class="fixed inset-0 z-[2147483647] pointer-events-none" style="z-index: 2147483647;">

        <!-- AI 助手容器（Wrapper） -->
        <div id="ai-wrapper" class="absolute pointer-events-auto transform transition-none"
            style="will-change: transform; cursor: pointer;">

            <!-- AI 3D 角色 -->
            <div id="ai-character" class="relative transition-all duration-300" style="width: 180px; height: 220px;">
                <!-- Three.js 3D 渲染容器 -->
                <canvas id="character-3d-canvas" style="width: 100%; height: 100%;"></canvas>
                <!-- 点击提示 -->
                <div
                    class="absolute -top-10 left-1/2 -translate-x-1/2 whitespace-nowrap px-3 py-1.5 rounded-full bg-ink-800 text-ink-100 text-xs font-serif opacity-0 hover:opacity-100 transition-opacity pointer-events-none border border-ink-600">
                    建立神经连接
                </div>
            </div>

            <!-- 聊天面板 -->
            <div id="chat-panel"
                class="absolute right-[120%] bottom-0 w-80 h-96 bg-ink-800 rounded-lg shadow-lg hidden transition-all duration-300 flex flex-col"
                style="border: 1px solid rgba(196, 92, 72, 0.3); box-shadow: 0 8px 32px rgba(255, 0, 0, 0.3), 0 0 0 4px rgba(255,255,255,0.1), 0 0 0 6px rgba(196, 92, 72, 0.2); z-index: 1;">
                <!-- 聊天面板头部 -->
                <div class="flex justify-between items-center p-4 border-b border-ink-700">
                    <h3 class="text-ink-100 font-serif text-lg">云朵</h3>
                    <button id="close-chat" class="text-ink-400 hover:text-ink-100 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- 消息列表 -->
                <div id="message-list" class="flex-1 p-4 overflow-y-auto" style="scroll-behavior: smooth;">
                    <div class="flex mb-4">
                        <div
                            class="w-8 h-8 rounded-full bg-cinnabar flex items-center justify-center mr-2 flex-shrink-0">
                            <i class="fas fa-robot text-white text-xs"></i>
                        </div>
                        <div class="bg-ink-700 rounded-lg p-3 max-w-[80%]">
                            <p class="text-ink-100 text-sm">你好！我是云朵，[清宇]的数字分身。我不仅是产品的开发者，更是 AI
                                驱动方法论的践行者。今天想找我聊聊技术，还是看看我的进化记录？</p>
                        </div>
                    </div>
                </div>

                <!-- 输入区 -->
                <div class="p-4 border-t border-ink-700 flex-shrink-0">
                    <div class="flex">
                        <input type="text" id="chat-input"
                            class="flex-1 bg-ink-700 border border-ink-600 rounded-l-lg px-4 py-2 text-ink-100 focus:outline-none focus:border-cinnabar"
                            placeholder="输入消息...">
                        <button id="send-message"
                            class="bg-cinnabar hover:bg-red-600 transition-colors px-4 py-2 rounded-r-lg text-white">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coze Web SDK 已移除，改用 API 直接调用 -->

    <!-- Three.js 3D 渲染库 (使用兼容版本) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.137.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.137.0/examples/js/loaders/GLTFLoader.js"></script>

    <script>
            // ==================== Three.js 3D 角色渲染 ====================
            (function init3DCharacter() {
                const canvas = document.getElementById('character-3d-canvas');
                if (!canvas) return;

                // 创建场景
                const scene = new THREE.Scene();

                // 创建相机
                const camera = new THREE.PerspectiveCamera(45, 180 / 220, 0.1, 1000);
                camera.position.set(0, 0.5, 2.5);

                // 创建渲染器（透明背景）
                const renderer = new THREE.WebGLRenderer({
                    canvas: canvas,
                    alpha: true,
                    antialias: true
                });
                renderer.setSize(180, 220);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.outputEncoding = THREE.sRGBEncoding;
                renderer.toneMapping = THREE.ACESFilmicToneMapping;
                renderer.toneMappingExposure = 1.2;

                // 添加环境光
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
                scene.add(ambientLight);

                // 添加主光源（模拟阳光）
                const mainLight = new THREE.DirectionalLight(0xfff5e6, 1.2);
                mainLight.position.set(2, 3, 2);
                scene.add(mainLight);

                // 添加补光（减少暗部）
                const fillLight = new THREE.DirectionalLight(0xc4e0ff, 0.5);
                fillLight.position.set(-2, 1, -1);
                scene.add(fillLight);

                // 添加底部暖光（营造氛围）
                const warmLight = new THREE.PointLight(0xc45c48, 0.4, 5);
                warmLight.position.set(0, -1, 1);
                scene.add(warmLight);

                // 加载 3D 模型
                let model = null;
                let modelCenter = new THREE.Vector3();
                const loader = new THREE.GLTFLoader();

                // 鼠标位置跟踪
                let mouseX = 0;
                let mouseY = 0;
                let targetX = 0;
                let targetY = 0;

                window.addEventListener('mousemove', (event) => {
                    mouseX = (event.clientX / window.innerWidth) * 2 - 1;
                    mouseY = (event.clientY / window.innerHeight) * 2 - 1;
                });

                loader.load(
                    'eef1ba0d138faa8a9eb606502b2963f4.glb',
                    function (gltf) {
                        model = gltf.scene;
                        const box = new THREE.Box3().setFromObject(model);
                        const center = box.getCenter(new THREE.Vector3());
                        const size = box.getSize(new THREE.Vector3());
                        modelCenter.copy(center);
                        model.position.x = -center.x;
                        model.position.y = -center.y;
                        model.position.z = -center.z;
                        const maxDim = Math.max(size.x, size.y, size.z);
                        const scale = 1.5 / maxDim;
                        model.scale.setScalar(scale);
                        scene.add(model);
                        console.log('3D 模型加载成功！');
                        animate();
                    },
                    function (xhr) {
                        if (xhr.total) { console.log('模型加载进度: ' + (xhr.loaded / xhr.total * 100).toFixed(0) + '%'); }
                    },
                    function (error) { console.error('模型加载失败:', error); }
                );

                function animate() {
                    requestAnimationFrame(animate);
                    if (model) {
                        targetX = mouseY * 0.3;
                        targetY = mouseX * 0.5;
                        model.rotation.x += (targetX - model.rotation.x) * 0.05;
                        model.rotation.y += (targetY - model.rotation.y) * 0.05;
                        model.position.y = -modelCenter.y + Math.sin(Date.now() * 0.001) * 0.03;
                        model.rotation.z = Math.sin(Date.now() * 0.0005) * 0.02;
                    }
                    renderer.render(scene, camera);
                }
            })();
    </script>





    <script>
        // ==================== 水墨流体 Canvas 动画 ====================
        const canvas = document.getElementById('ink-canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let particles = [];
        let animationId;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        class InkParticle {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 100 + 50;
                this.speedX = (Math.random() - 0.5) * 0.3;
                this.speedY = (Math.random() - 0.5) * 0.3;
                this.opacity = Math.random() * 0.03 + 0.01;
                this.life = 0;
                this.maxLife = Math.random() * 500 + 300;
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.life++;

                // 边界检测
                if (this.x < -this.size || this.x > width + this.size ||
                    this.y < -this.size || this.y > height + this.size ||
                    this.life > this.maxLife) {
                    this.reset();
                }
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity * Math.sin((this.life / this.maxLife) * Math.PI);

                // 创建水墨渐变
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.size
                );
                gradient.addColorStop(0, 'rgba(40, 40, 40, 0.8)');
                gradient.addColorStop(0.4, 'rgba(60, 60, 60, 0.3)');
                gradient.addColorStop(1, 'rgba(80, 80, 80, 0)');

                ctx.fillStyle = gradient;
                ctx.beginPath();

                // 不规则形状模拟水墨晕染
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2;
                    const radius = this.size * (0.8 + Math.random() * 0.4);
                    const px = this.x + Math.cos(angle) * radius;
                    const py = this.y + Math.sin(angle) * radius;
                    if (i === 0) {
                        ctx.moveTo(px, py);
                    } else {
                        ctx.lineTo(px, py);
                    }
                }
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }
        }

        function initParticles() {
            particles = [];
            const particleCount = Math.min(15, Math.floor((width * height) / 80000));
            for (let i = 0; i < particleCount; i++) {
                particles.push(new InkParticle());
            }
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);

            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            animationId = requestAnimationFrame(animate);
        }

        // 初始化
        resize();
        initParticles();
        animate();

        window.addEventListener('resize', () => {
            resize();
            initParticles();
        });

        // ==================== AI 动漫角色 ====================
        const aiWrapper = document.getElementById('ai-wrapper');
        const aiCharacter = document.getElementById('ai-character');
        const chatPanel = document.getElementById('chat-panel');
        const closeChatBtn = document.getElementById('close-chat');
        const chatInput = document.getElementById('chat-input');
        const sendMessageBtn = document.getElementById('send-message');
        const messageList = document.getElementById('message-list');

        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let offsetX = 0;
        let offsetY = 0;
        let moved = false; // 用于区分点击和拖拽
        let isParallaxActive = true;
        let isChatOpen = false; // 跟踪聊天面板的显示状态
        let currentState = 'idle'; // 状态机：idle, hover, dragging, chat-open, thinking
        const dragThreshold = 5; // 拖拽阈值

        // 状态管理函数
        function setState(newState) {
            if (newState === currentState) return;

            const oldState = currentState;
            currentState = newState;

            console.log(`状态从 ${oldState} 变为 ${newState}`);
            updateUIByState();
        }

        // 根据状态更新UI
        function updateUIByState() {
            switch (currentState) {
                case 'idle':
                    aiCharacter.style.animation = 'float 4s ease-in-out infinite, glow 3s ease-in-out infinite';
                    aiCharacter.style.opacity = '1';
                    aiCharacter.style.cursor = 'pointer';
                    chatPanel.classList.add('hidden');
                    break;
                case 'hover':
                    aiCharacter.style.animation = 'float 4s ease-in-out infinite, glow 3s ease-in-out infinite';
                    aiCharacter.style.transform = 'scale(1.05)';
                    aiCharacter.style.opacity = '1';
                    break;
                case 'dragging':
                    aiCharacter.style.animation = 'none';
                    aiCharacter.style.transform = 'none';
                    aiCharacter.style.cursor = 'grabbing';
                    aiCharacter.style.opacity = '0.9';
                    break;
                case 'chat-open':
                    aiCharacter.style.animation = 'chat-active 1s ease-in-out infinite';
                    aiCharacter.style.opacity = '0.8';
                    chatPanel.classList.remove('hidden');
                    break;
                case 'thinking':
                    aiCharacter.style.animation = 'thinking 2s ease-in-out infinite';
                    aiCharacter.style.opacity = '0.6';
                    break;
            }
        }

        // 初始化
        function init() {
            // 设置初始位置
            setInitialPosition();

            // 加载保存的位置
            loadSavedPosition();

            // 绑定事件监听器
            bindEventListeners();

            console.log('AI 动漫角色初始化完成');
        }

        // 设置初始位置
        function setInitialPosition() {
            // 默认位置：右下角（向上调整 100px，避免与右下角按钮冲突）
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            const characterWidth = aiCharacter.offsetWidth;
            const characterHeight = aiCharacter.offsetHeight;

            const defaultX = windowWidth - characterWidth - 32; // 右侧边距 32px
            const defaultY = windowHeight - characterHeight - 132; // 下边距 132px（向上调整 100px）

            // 使用 transform 设置初始位置
            aiWrapper.style.transform = `translate3d(${defaultX}px, ${defaultY}px, 0)`;
        }

        // 绑定事件监听器
        function bindEventListeners() {
            // 3D 视差效果
            document.addEventListener('mousemove', handleMouseMove);

            // 角色事件
            aiCharacter.addEventListener('mousedown', startDrag);
            aiCharacter.addEventListener('mouseenter', handleMouseEnter);
            aiCharacter.addEventListener('mouseleave', handleMouseLeave);

            // 聊天面板事件
            closeChatBtn.addEventListener('click', closeChat);
            sendMessageBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // 3D 视差效果
        function handleMouseMove(e) {
            if (!isDragging && isParallaxActive) {
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                const mouseX = e.clientX;
                const mouseY = e.clientY;

                // 计算鼠标位置相对于窗口中心的偏移量
                const xAxis = (windowWidth / 2 - mouseX) / 25;
                const yAxis = (windowHeight / 2 - mouseY) / 25;

                // 应用 3D 变换
                aiCharacter.style.transform = `rotateY(${xAxis}deg) rotateX(${-yAxis}deg)`;
            }
        }

        // 鼠标进入
        function handleMouseEnter() {
            if (currentState !== 'dragging' && currentState !== 'chat-open') {
                setState('hover');
            }
        }

        // 鼠标离开
        function handleMouseLeave() {
            if (currentState !== 'dragging' && currentState !== 'chat-open') {
                setState('idle');
                aiCharacter.style.transform = 'scale(1)';
            }
        }

        // 开始拖拽
        function startDrag(e) {
            // 记录初始状态
            isDragging = false;
            moved = false;
            setState('dragging');

            // 记录鼠标起始位置
            startX = e.clientX;
            startY = e.clientY;

            // 计算初始偏移量
            const rect = aiCharacter.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            // 暂停动画和视差效果
            isParallaxActive = false;
            aiCharacter.classList.add('dragging');
            aiCharacter.style.animation = 'none';
            aiCharacter.style.transform = 'none'; // 清除 3D 变换

            // 添加临时的鼠标移动和抬起事件监听器
            document.addEventListener('mousemove', onDrag);
            document.addEventListener('mouseup', endDrag);
        }

        // 拖拽中
        function onDrag(e) {
            // 计算位移
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

            // 如果位移超过阈值，开始拖拽
            if (distance >= dragThreshold) {
                isDragging = true;
                moved = true;
            }

            // 只有在拖拽状态时才更新位置
            if (isDragging) {
                e.preventDefault();

                // 计算新位置
                let newX = e.clientX - offsetX;
                let newY = e.clientY - offsetY;

                // 边界限制
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                const characterWidth = aiCharacter.offsetWidth;
                const characterHeight = aiCharacter.offsetHeight;

                // 限制在视口内
                newX = Math.max(0, Math.min(windowWidth - characterWidth, newX));
                newY = Math.max(0, Math.min(windowHeight - characterHeight, newY));

                // 使用 transform 更新位置
                aiWrapper.style.transform = `translate3d(${newX}px, ${newY}px, 0)`;
            }
        }

        // 结束拖拽
        function endDrag(e) {
            // 移除临时事件监听器
            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('mouseup', endDrag);

            // 恢复动画和视差效果
            isParallaxActive = true;
            aiCharacter.classList.remove('dragging');
            aiCharacter.style.animation = 'float 4s ease-in-out infinite, glow 3s ease-in-out infinite';

            // 智能点击判断
            if (!moved) {
                // 只是点了一下，没移动，切换聊天面板的显示/隐藏状态
                if (isChatOpen) {
                    closeChat();
                } else {
                    openChat();
                }
            } else {
                // 拖拽结束，保存位置
                savePosition();

                // 默认吸附右侧
                snapToRight();
            }

            // 重置拖拽状态
            isDragging = false;
            moved = false;
            // 只有在没有打开聊天面板的情况下才设置为 idle 状态
            if (!isChatOpen) {
                setState('idle');
            }
        }

        // 吸附到右侧
        function snapToRight() {
            const windowWidth = window.innerWidth;
            const characterWidth = aiCharacter.offsetWidth;
            const newX = windowWidth - characterWidth - 32; // 32px 边距

            // 获取当前 Y 位置
            const currentTransform = aiWrapper.style.transform;
            const match = currentTransform.match(/translate3d\(([^,]+)px, ([^,]+)px, ([^,]+)px\)/);
            const currentY = match ? parseFloat(match[2]) : 0;

            // 平滑过渡
            aiWrapper.style.transition = 'transform 0.3s ease';
            aiWrapper.style.transform = `translate3d(${newX}px, ${currentY}px, 0)`;

            setTimeout(() => {
                aiWrapper.style.transition = '';
            }, 300);
        }

        // 保存位置
        function savePosition() {
            const transform = aiWrapper.style.transform;
            const match = transform.match(/translate3d\(([^,]+)px, ([^,]+)px, ([^,]+)px\)/);

            if (match) {
                const position = {
                    x: parseFloat(match[1]),
                    y: parseFloat(match[2])
                };

                localStorage.setItem('aiCharacterPosition', JSON.stringify(position));
                console.log('位置已保存:', position);
            }
        }

        // 加载保存的位置
        function loadSavedPosition() {
            const savedPosition = localStorage.getItem('aiCharacterPosition');
            if (savedPosition) {
                try {
                    const position = JSON.parse(savedPosition);
                    aiWrapper.style.transform = `translate3d(${position.x}px, ${position.y}px, 0)`;
                    console.log('加载保存的位置:', position);
                } catch (error) {
                    console.error('加载位置失败:', error);
                }
            }
        }

        // 打开聊天面板
        function openChat() {
            if (!isChatOpen) {
                isChatOpen = true;
                setState('chat-open');

                console.log('聊天面板已打开');
            }
        }

        // 关闭聊天面板
        function closeChat() {
            if (isChatOpen) {
                isChatOpen = false;
                setState('idle');
                chatPanel.classList.add('hidden');

                console.log('聊天面板已关闭');
            }
        }

        // 发送消息
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (message) {
                // 添加用户消息
                addMessage('user', message);

                // 清空输入框
                chatInput.value = '';

                // 显示 AI 思考状态
                setState('thinking');

                // 创建 AI 回复消息元素（用于流式更新）
                const aiMessageDiv = createStreamingMessage();

                try {
                    // 调用流式 AI 服务
                    await aiService.sendMessageStreaming(message, (chunk) => {
                        // 实时更新消息内容
                        updateStreamingMessage(aiMessageDiv, chunk);
                    });
                    setState('chat-open');
                } catch (error) {
                    setState('chat-open');
                    updateStreamingMessage(aiMessageDiv, '抱歉，我暂时无法回复你的消息，请稍后再试。');
                    console.error('获取 AI 回复失败:', error);
                }
            }
        }

        // 创建流式消息元素
        function createStreamingMessage() {
            const messageList = document.getElementById('message-list');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex mb-4';
            messageDiv.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-cinnabar flex items-center justify-center mr-2 flex-shrink-0">
                    <i class="fas fa-robot text-white text-xs"></i>
                </div>
                <div class="bg-ink-700 rounded-lg p-3 max-w-[80%]">
                    <p class="text-ink-100 text-sm streaming-content">▌</p>
                </div>
            `;
            messageList.appendChild(messageDiv);
            scrollToBottom();
            return messageDiv;
        }

        // 更新流式消息内容
        function updateStreamingMessage(messageDiv, content) {
            const contentEl = messageDiv.querySelector('.streaming-content');
            if (contentEl) {
                contentEl.textContent = content + '▌';
                scrollToBottom();
            }
        }

        // 完成流式消息（移除光标）
        function finalizeStreamingMessage(messageDiv, content) {
            const contentEl = messageDiv.querySelector('.streaming-content');
            if (contentEl) {
                contentEl.textContent = content;
                scrollToBottom();
            }
        }

        // 滚动到底部
        function scrollToBottom() {
            const messageList = document.getElementById('message-list');
            requestAnimationFrame(() => {
                messageList.scrollTop = messageList.scrollHeight;
            });
        }

        // 添加消息
        function addMessage(sender, text, isThinking = false) {
            const messageList = document.getElementById('message-list');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex mb-4 ${sender === 'user' ? 'justify-end' : ''}`;

            if (sender === 'ai') {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-cinnabar flex items-center justify-center mr-2 flex-shrink-0">
                        <i class="fas fa-robot text-white text-xs"></i>
                    </div>
                    <div class="bg-ink-700 rounded-lg p-3 max-w-[80%] ${isThinking ? 'thinking-message' : ''}">
                        <p class="text-ink-100 text-sm">${text}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="bg-cinnabar/20 rounded-lg p-3 max-w-[80%]">
                        <p class="text-ink-100 text-sm">${text}</p>
                    </div>
                `;
            }

            messageList.appendChild(messageDiv);
            scrollToBottom();
        }

        // 初始化
        init();

        // ==================== Coze SDK/API 集成功能 ====================
        // 配置信息
        const COZE_CONFIG = {
            bot_id: '7602919199299846184',
            token: 'pat_ERPSKRUV3FnTLtFffnVUVRPXfRtLvJSMYHYJKrFxrGgXVc42ND1qGh3NkS6WUsek',
            user_id: 'web_user_' + Math.random().toString(36).substr(2, 9)
        };

        // 封装 AI 服务
        const aiService = {
            conversationId: null, // 保存会话 ID 用于连续对话

            // 流式发送消息 - 实时显示回复
            async sendMessageStreaming(text, onChunk) {
                let fullContent = '';

                try {
                    console.log('正在调用 Coze 流式 API...', text);

                    const requestBody = {
                        bot_id: COZE_CONFIG.bot_id,
                        user_id: COZE_CONFIG.user_id,
                        additional_messages: [
                            {
                                role: 'user',
                                content: text,
                                content_type: 'text'
                            }
                        ],
                        stream: true // 启用流式输出
                    };

                    // 如果有会话 ID，加入到请求中实现连续对话
                    if (this.conversationId) {
                        requestBody.conversation_id = this.conversationId;
                    }

                    const response = await fetch('https://api.coze.cn/v3/chat', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${COZE_CONFIG.token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP 错误! 状态码: ${response.status}`);
                    }

                    // 读取流式响应
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let buffer = '';

                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;

                        buffer += decoder.decode(value, { stream: true });

                        // 处理 SSE 格式的数据
                        const lines = buffer.split('\n');
                        buffer = lines.pop() || ''; // 保留最后一个不完整的行

                        for (const line of lines) {
                            if (line.startsWith('data:')) {
                                const jsonStr = line.slice(5).trim();
                                if (jsonStr && jsonStr !== '[DONE]') {
                                    try {
                                        const event = JSON.parse(jsonStr);

                                        // 保存会话 ID
                                        if (event.conversation_id) {
                                            this.conversationId = event.conversation_id;
                                        }

                                        // 处理消息内容
                                        if (event.type === 'answer' && event.content) {
                                            fullContent = event.content;
                                            onChunk(fullContent);
                                        } else if (event.role === 'assistant' && event.type === 'answer' && event.content) {
                                            fullContent = event.content;
                                            onChunk(fullContent);
                                        }
                                    } catch (e) {
                                        // 忽略解析错误
                                    }
                                }
                            }
                        }
                    }

                    // 如果没有收到内容，显示默认消息
                    if (!fullContent) {
                        onChunk('收到了你的消息，但暂时没有回复内容。');
                    }

                    return fullContent;

                } catch (error) {
                    console.error('Coze 流式 API 调用失败:', error);
                    onChunk('抱歉，连接 AI 助手时出了点小问题：' + error.message);
                    throw error;
                }
            },

            // 非流式发送消息（备用）

            // 使用 Fetch 直接调用 Coze API (v3 Chat)
            async sendMessage(text) {
                try {
                    console.log('正在调用 Coze API...', text);

                    const requestBody = {
                        bot_id: COZE_CONFIG.bot_id,
                        user_id: COZE_CONFIG.user_id,
                        additional_messages: [
                            {
                                role: 'user',
                                content: text,
                                content_type: 'text'
                            }
                        ],
                        stream: false
                    };

                    // 如果有会话 ID，加入到请求中实现连续对话
                    if (this.conversationId) {
                        requestBody.conversation_id = this.conversationId;
                    }

                    const response = await fetch('https://api.coze.cn/v3/chat', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${COZE_CONFIG.token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestBody)
                    });

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('API 错误响应:', errorText);
                        throw new Error(`HTTP 错误! 状态码: ${response.status}`);
                    }

                    const data = await response.json();
                    console.log('Coze API 响应:', data);

                    if (data.code !== 0) {
                        throw new Error(data.msg || 'API 返回错误');
                    }

                    // 保存会话 ID 用于后续对话
                    if (data.data && data.data.conversation_id) {
                        this.conversationId = data.data.conversation_id;
                    }

                    // 获取 chat_id 用于轮询
                    const chatId = data.data?.id;
                    const conversationId = data.data?.conversation_id;

                    if (!chatId || !conversationId) {
                        return '创建对话失败，请重试。';
                    }

                    // 轮询直到对话完成
                    return await this.pollAndGetResponse(chatId, conversationId);

                } catch (error) {
                    console.error('Coze API 调用失败:', error);
                    return '抱歉，连接 AI 助手时出了点小问题：' + error.message;
                }
            },

            // 轮询对话状态并获取回复
            async pollAndGetResponse(chatId, conversationId) {
                let attempts = 0;
                const maxAttempts = 30; // 最多等待 60 秒

                while (attempts < maxAttempts) {
                    await new Promise(resolve => setTimeout(resolve, 2000));

                    try {
                        // 查询对话状态
                        const statusResponse = await fetch(
                            `https://api.coze.cn/v3/chat/retrieve?chat_id=${chatId}&conversation_id=${conversationId}`,
                            {
                                method: 'GET',
                                headers: {
                                    'Authorization': `Bearer ${COZE_CONFIG.token}`
                                }
                            }
                        );

                        if (!statusResponse.ok) continue;

                        const statusData = await statusResponse.json();
                        console.log('对话状态:', statusData);

                        if (statusData.code !== 0) continue;

                        const status = statusData.data?.status;

                        if (status === 'completed') {
                            // 对话完成，获取消息列表
                            return await this.getMessages(chatId, conversationId);
                        } else if (status === 'failed') {
                            return '对话处理失败，请重试。';
                        }
                        // 其他状态（如 in_progress）继续等待

                    } catch (e) {
                        console.error('轮询出错:', e);
                    }

                    attempts++;
                }

                return '回复超时，请稍后再试。';
            },

            // 获取对话消息
            async getMessages(chatId, conversationId) {
                try {
                    const response = await fetch(
                        `https://api.coze.cn/v3/chat/message/list?chat_id=${chatId}&conversation_id=${conversationId}`,
                        {
                            method: 'GET',
                            headers: {
                                'Authorization': `Bearer ${COZE_CONFIG.token}`
                            }
                        }
                    );

                    if (!response.ok) {
                        throw new Error('获取消息失败');
                    }

                    const data = await response.json();
                    console.log('消息列表:', data);

                    if (data.code !== 0 || !data.data) {
                        return '解析回复失败。';
                    }

                    // 从消息列表中找到 assistant 的 answer 类型消息
                    const messages = data.data;
                    const botMessage = messages.find(
                        msg => msg.role === 'assistant' && msg.type === 'answer'
                    );

                    if (botMessage && botMessage.content) {
                        return botMessage.content;
                    }

                    // 如果没找到 answer 类型，尝试找任何 assistant 消息
                    const anyBotMessage = messages.find(msg => msg.role === 'assistant');
                    if (anyBotMessage && anyBotMessage.content) {
                        return anyBotMessage.content;
                    }

                    return '机器人没有返回回复。';

                } catch (e) {
                    console.error('获取消息出错:', e);
                    return '获取回复失败：' + e.message;
                }
            }
        };

        // ==================== 平滑滚动 ====================
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // ==================== 终端内容渐入效果 ====================
        function fadeInTerminal() {
            const lines = document.querySelectorAll('.terminal-line, .bamboo-terminal .pl-4, .bamboo-terminal .mt-8');
            lines.forEach((line, index) => {
                line.style.opacity = '0';
                line.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    line.style.transition = 'all 0.5s ease';
                    line.style.opacity = '1';
                    line.style.transform = 'translateY(0)';
                }, index * 150);
            });
        }

        // 页面加载完成后执行渐入效果
        window.addEventListener('load', () => {
            setTimeout(fadeInTerminal, 300);

            // 移除 Coze 相关的 UI 元素
            removeCozeElements();
        });

        // 移除 Coze 相关的 UI 元素
        function removeCozeElements() {
            // 延迟执行，确保 Coze SDK 已经初始化
            setTimeout(() => {
                // 查找并移除所有可能的 Coze 相关元素
                const cozeSelectors = [
                    '.coze-web-chat-floating-btn',
                    '.coze-floating-btn',
                    '.coze-chat-btn',
                    '.coze-widget-btn',
                    '[class*="coze"][class*="btn"]',
                    '[class*="coze"][class*="floating"]',
                    '[class*="coze"][class*="widget"]',
                    '[class*="coze"]',
                    'iframe[src*="coze"]'
                ];

                cozeSelectors.forEach(selector => {
                    const elements = document.querySelectorAll(selector);
                    elements.forEach(element => {
                        if (element) {
                            console.log('移除 Coze 元素:', element.className || element.tagName);
                            element.remove();
                        }
                    });
                });
            }, 1000);
        }

        // ==================== 视差滚动效果 ====================
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const parallax = document.querySelectorAll('.ink-blob');
            parallax.forEach((blob, index) => {
                const speed = 0.1 + (index * 0.05);
                blob.style.transform = `translateY(${scrolled * speed}px)`;
            });
        });
    </script>
</body>

</html>